- Viết lua để integrate với software khác như C/C++
- Không cố gắng làm thứ mà C đã tốt rồi
- What Lua does offer is what C is not good for: a good distance from the hardware, dynamic structures, no redundancies, and ease of testing and debugging. For these goals, Lua has a safe environment, automatic memory management, and good facilities for handling strings and other kinds of data with dynamic size
- Power lua từ lib - khả năng mở rộng
- Lua ko chỉ là extensible language mà còn là glue language (gắn kết các thành phần software)

---
- Lua chia 3 nhóm người dùng: nhúng, dùng riêng (standalone), Lua và C
…

----
- Load thư viện:
```dofile("lib1.lua")```
- comment code nhiều dòng
```
--[[
print(10)
---]]
```
trick để bỏ comment nhiều dòng: thêm dấu - đằng trước thành 3 cái `---[[`

### Global variable
- Không cần khai báo, cứ sử dụng là global
```
b = 10
```

### Types
- Dùng hàm type() để biết biến có giá trị gì

```
> type(nil) --> nil
 > type(true) --> boolean
 > type(10.4 * 3) --> number
 > type("Hello world") --> string
 > type(io.stdin) --> userdata
 > type(print) --> function
 > type(type) --> function
 > type({}) --> table
 > type(type(X)) --> string
```

#### Boolean
- false: false, nil
- true: còn lại (kể cả 0 và string rỗng)
- and: a and b
    * nếu a false trả về a
    * còn lại trả về b
- or: a or b
    * nếu a true trả về a
    * còn lại trả về b
  
đoạn này lằng nhằng vkl
      
- Ứng dụng viết cho ngắn gọn:
x = x or v 
thay vì
if not x then x = v end
  
#### Standalone interpreter
- lua -e "print(math.sin(12))"
--> -e cho phép gõ code trực tiếp trong terminal để chạy
  
- lua -i -llib -e "x=10"
--> -i chạy interactive mode; -l: load thư viện (llib = load thư viện lib)
  
- lua -e "sin=math.sin" script a b
--> Từ khóa script sẽ coi nó là arg[0]. Vậy
```
arg[-3] = "lua"
arg[-2] = "-e"
arg[-1] = "sin=math.sin"
arg[0] = "script"
arg[1] = "a"
arg[2] = "b"
  ```

---
Exercises:

1.1 
```
function factorial(n)
    if n < 0 then
        return false
    end

    if n == 0 then
        return 1
    end

    return n * factorial(n - 1)
end

print("Enter a number: ")
a = io.read("*n")
res = factorial(a)

if res == false then
    print("Negative number is not valid")
    return
end
```

1.5    

type(nil) == nil --> false vì hàm type luôn trả về string.

1.6: Check kiểu boolean bằng hàm type

```
type(a) == "boolean"
```

1.7: Viết script in ra tên của chính nó đang chạy
print(arg[0])


## Chap 2: 8-queen problem

```
---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by adminpc.
--- DateTime: 30/01/2021 15:20
---

N = 8 --board size

-- check whether position (n, c) is free from attacks
function isplacedok(a, n, c)
    for i = 1, n - 1 do
        -- for each quen already placed
        if (a[i] == c) or -- same column?
                (a[i] - i == c - n) or -- same diagonal?
                (a[i] + i == c - n) then
            -- same diagonal?
            return false --place can be attacked
        end
    end

    return true -- no attacks; place is OK
end

-- print a board
function printsolution (a)
    for i = 1, N do
        -- for each row
        for j = 1, N do
            -- for each column
            -- write "X" or "-" plus a space
            io.write(a[i] == j and "X" or "-", " ")
        end
        io.write("\n")
    end
    io.write("\n")
end

-- add to board 'a' all queens from 'n' to 'N'
function addqueen(a, n)
    if n > N then
        -- all queen has been placed
        printsolution(a)
        return
    else
        -- try to place n-th queen
        for c = 1, N do
            if isplacedok(a, n, c) then
                a[n] = c -- place n-th queen at column 'c'
                addqueen(a, n +1)
            end
        end
    end
end

-- run the program
addqueen({}, 1)
```

### Exercises
2.1: Sửa chương trình để in ra bàn đầu tiên sẽ dừng lại
2.2: An alternative implementation for the eight-queen problem would be to generate all possible
permutations of 1 to 8 and, for each permutation, to check whether it is valid. Change the program to use
this approach. How does the performance of the new program compare with the old one? (Hint: compare
the total number of permutations with the number of times that the original program calls the function
isplaceok

## Chap 3: Number

```
> 4 --> 4
> 0.4 --> 0.4
> 4.57e-3 --> 0.00457
> 0.3e12 --> 300000000000.0
> 5E+20 --> 5e+20
```

Dùng hàm type luôn trả về number

```
> type(3) --> number
> type(3.5) --> number
> type(3.0) --> number
```

So sánh số nguyên và số thực cùng giá trị thì vẫn có thể bằng nhau

```
> 1 == 1.0 --> true
> -3 == -3.0 --> true
> 0.2e3 == 200 --> true
 ```

Muốn lấy kiểu dữ liệu chính xác, dùng `math.type`

```
> math.type(3) --> integer
> math.type(3.0) --> float
```

### Toán tử số học (cần đọc kĩ lại)

```
> 13 + 15 --> 28
> 13.0 + 15.0 --> 28.0

> 13.0 + 25 --> 38.0
> -(3 * 6.0) --> -18.0

> 3.0 / 2.0 --> 1.5
> 3 / 2 --> 1.5
```

toán tử // = floor division

```
> 3 // 2 --> 1
> 3.0 // 2 --> 1.0
> 6 // 2 --> 3
> 6.0 // 2.0 --> 3.0
> -9 // 2 --> -5
> 1.5 // 0.5 --> 3.0
```
### Thư viện math
```
> math.sin(math.pi / 2) --> 1.0
> math.max(10.4, 7, -3, 20) --> 20
> math.huge --> inf
```

### Random

```
- random() -> [0, 1)
- random(n) -> [1, n)
- random(n,m) -> [n,m]
```

### Rouding function
floor, ceil, modf
- floor: làm tròn xuống
- ceil: làm tròn lên
- modf: làm tròn về 0

```
> math.floor(3.3) --> 3
> math.floor(-3.3) --> -4

> math.ceil(3.3) --> 4
> math.ceil(-3.3) --> -3
> math.modf(3.3) --> 3 0.3
> math.modf(-3.3) --> -3 -0.3
> math.floor(2^70) --> 1.1805916207174e+21
```

## Chap 4: String
```
a = "one string"
b = string.gsub(a, "one", "another") -- change string parts
print(a) --> one string
print(b) --> another string
```
Lấy độ dài string

```
a = "hello"
print(#a) --> 5
print(#"good bye") --> 8
```

Dùng .. để nối chuỗi. Nếu là số sẽ tự convert thành số

```
> "Hello " .. "World" --> Hello World
> "result is " .. 3 --> result is 3
```

Chuỗi dài dùng `[[ ]]` để biểu thị

```
page = [[
 <html>
 <head>
 <title>An HTML Page</title>
 </head>
 <body>
 <a href="http://www.lua.org">Lua</a>
 </body>
 </html>
 ]]

 write(page)
```

Thư viện string

```
> string.rep("abc", 3) --> abcabcabc
> string.reverse("A Long Line!") --> !eniL gnoL A
> string.lower("A Long Line!") --> a long line!
> string.upper("A Long Line!") --> A LONG LINE!

string.lower(a) < string.lower(b)
```

format

```
> string.format("x = %d y = %d", 10, 20) --> x = 10 y = 20
> string.format("x = %x", 200) --> x = c8
> string.format("x = 0x%X", 200) --> x = 0xC8
> string.format("x = %f", 200) --> x = 200.000000
> tag, title = "h1", "a title"
> string.format("<%s>%s</%s>", tag, title, tag)
--> <h1>a title</h1>
```

find & replace 
```
> string.find("hello world", "wor") --> 7 9
> string.find("hello world", "war") --> nil

> string.gsub("hello world", "l", ".") --> he..o wor.d 3
> string.gsub("hello world", "ll", "..") --> he..o world 1
> string.gsub("hello world", "a", ".") --> hello world 0
```

### Chap 5: Table
Table tương tự như map trong Go
```
> a = {} -- create a table and assign its reference
> k = "x"
> a[k] = 10 -- new entry, with key="x" and value=10
> a[20] = "great" -- new entry, with key=20 and value="great"
> a["x"] --> 10
> k = 20
> a[k] --> "great"
> a["x"] = a["x"] + 1 -- increments entry "x"
> a["x"] --> 11
```

#### Table constructor

```
days = {"Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"}
print(days[4]) --> Wednesday

a = {x = 10, y = 20}
tương đương với
 a = {}; a.x = 10; a.y = 20
```

```
w = {x = 0, y = 0, label = "console"}
x = {math.sin(0), math.sin(1), math.sin(2)}
w[1] = "another field" -- add key 1 to table 'w'
x.f = w -- add key "f" to table 'x'
print(w["x"]) --> 0
print(w[1]) --> another field
print(x.f[1]) --> another field
w.x = nil -- remove field "x"
```

```
polyline = {color="blue",
 thickness=2,
 npoints=4,
 {x=0, y=0}, -- polyline[1]
 {x=-10, y=0}, -- polyline[2]
 {x=-10, y=1}, -- polyline[3]
 {x=0, y=1} -- polyline[4]
 }
 
print(polyline[2].x) --> -10
print(polyline[4].y) --> 1
```

```
{x = 0, y = 0} <--> {["x"] = 0, ["y"] = 0}
{"r", "g", "b"} <--> {[1] = "r", [2] = "g", [3] = "b"}
```

### Arrays, Lists, and Sequences
